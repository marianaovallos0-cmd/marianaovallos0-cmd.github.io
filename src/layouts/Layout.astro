---
import "../styles/vars.css";
import "../styles/content.css";
import "../styles/layout.css";

import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";

export interface Props {
    title?: string;
    description?: string;
    children?: any;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="description" content={description || "Portfolio"} />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title || "Portfolio"}</title>

    <script is:inline>
    const savedLang = localStorage.getItem("lang") || "en";
    document.documentElement.setAttribute("lang", savedLang);

    document.addEventListener("DOMContentLoaded", () => {
        const elements = document.querySelectorAll("[data-en]");
        elements.forEach((el) => {
            const text = el.getAttribute(`data-${savedLang}`);
            if (text) el.textContent = text;
        });
    });
</script>


   
</head>

<body class="site-wrapper">
    <Header title={title} />

    <main id="site-main" class="site-main">
        <slot />
    </main>


    <Footer />

    <script>
    function setLanguage(lang) {
        document.documentElement.setAttribute("lang", lang);
        localStorage.setItem("lang", lang);

        const elements = document.querySelectorAll("[data-en]");
        elements.forEach((el) => {
            const text = el.getAttribute(`data-${lang}`);
            if (text) el.textContent = text;
        });

        const langText = document.getElementById("lang-text");
        if (langText) {
            langText.textContent = lang === "en" ? "ES" : "EN";
        }
    }

    function initLanguage() {
        const savedLang = localStorage.getItem("lang") || "en";
        setLanguage(savedLang);

        const langBtn = document.getElementById("lang-toggle");
        if (langBtn) {
            langBtn.onclick = () => {
                const current =
                    document.documentElement.getAttribute("lang") || "en";
                const next = current === "en" ? "es" : "en";
                setLanguage(next);
            };
        }
    }

    function initNav() {
        const burger = document.querySelector(".nav-burger");
        const wrapper = document.querySelector(".site-wrapper");
        if (burger && wrapper) {
            burger.onclick = (e) => {
                e.preventDefault();
                wrapper.classList.toggle("site-head-open");
            };
        }
    }

    function initAll() {
        initNav();
        initLanguage();
    }

    // Carga normal
    document.addEventListener("DOMContentLoaded", initAll);

    // Navegaci√≥n interna de Astro
    document.addEventListener("astro:page-load", initAll);
</script>

</body>
</html>
